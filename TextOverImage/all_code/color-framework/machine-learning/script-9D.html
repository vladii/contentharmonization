<html>
<body>

<h3>Hi! Vlad Ionescu wishes you a warm welcome!</h3>
<h1>Loss: </h1><div id="content_loss"></div>

<script src="http://cs.stanford.edu/people/karpathy/convnetjs/build/convnet.js"></script>

<script>
    // Trained data (manual, by designers)
    // H1,S1,B1,H2,S2,B2,H3,S3,B3,Hres,Sres,Bres
    pre_trained_data = [
                        0.07305936,0.86220473,0.99607843,0.79891306,0.40350878,0.89411765,0.913242,0.6952381,0.8235294,0.6595745,1.0,0.36862746,
                        0.8295669,0.85507244,0.8117647,0.6578014,0.41964287,0.8784314,0.043906808,0.75609756,0.9647059,0.0,0.0,1.0,
                        0.70934963,0.34893617,0.92156863,0.09108528,0.6013986,0.56078434,0.894027,0.96648043,0.7019608,0.16535948,1.0,1.0,
                        0.29696968,0.3525641,0.6117647,0.05494505,0.9479167,0.3764706,0.74404764,0.6930693,0.7921569,0.16535948,1.0,1.0,
                        0.17708333,0.72727275,0.6901961,0.98511904,0.7724138,0.5686275,0.40796018,0.9640288,0.54509807,0.0,0.0,1.0,
                        0.067708336,0.22535211,0.5568628,0.73036647,0.96464646,0.7764706,0.97578347,0.6,0.7647059,0.0,0.0,1.0,
                        0.5920398,0.70526314,0.74509805,0.9418239,0.6385542,0.6509804,0.66323024,0.4311111,0.88235295,0.83040935,0.23170732,0.9647059,
                        0.6969697,0.17529881,0.9843137,0.59999996,0.23809524,0.4117647,0.7550724,0.61497325,0.73333335,0.30952382,1.0,0.8235294,
                        0.6022222,0.48701298,0.6039216,0.5265487,1.0,0.44313726,0.05673759,0.8011364,0.6901961,0.30952382,1.0,0.8235294,
                        0.63958335,0.5298013,0.5921569,0.6137071,0.55440414,0.75686276,0.2021858,0.9037037,0.5294118,0.30952382,1.0,0.8235294,
                        0.7916667,0.0952381,0.9882353,0.7110656,0.9918699,0.9647059,0.14857881,0.8835617,0.57254905,0.83419245,0.95098037,0.8,
                        0.28625235,0.71659917,0.96862745,0.7434457,0.6793893,0.5137255,0.46130952,0.46861926,0.9372549,0.0,0.6,1.0,
                        0.5232558,0.38565022,0.8745098,0.117886186,0.35042736,0.45882353,0.89555556,0.31120333,0.94509804,0.59562844,0.73493975,0.6509804,
                        0.33564815,0.6180258,0.9137255,0.86507934,0.9375,0.8784314,0.1738782,0.94545454,0.8627451,0.0,0.0,0.0,
                        0.24761903,0.40697673,0.6745098,0.08091286,0.98770493,0.95686275,0.38037634,0.60194176,0.80784315,0.0,0.0,0.0,
                        0.64066195,0.6184211,0.89411765,0.83487654,0.44262296,0.95686275,0.23002756,0.9918033,0.47843137,0.0,0.0,0.0,
                        0.7924679,0.8489796,0.9607843,0.25387597,0.65648854,0.5137255,0.09401709,0.962963,0.63529414,0.0,0.0,1.0,
                        0.75661373,0.63,0.78431374,0.07183909,0.30851063,0.7372549,0.15876438,0.94693875,0.9607843,0.0,0.9327731,0.93333334,
                        0.93333334,0.41666666,0.7529412,0.9626437,0.33142856,0.6862745,0.76222223,0.35885167,0.81960785,0.34509802,1.0,1.0,
                        0.55982906,0.7677165,0.99607843,0.5416667,0.68016195,0.96862745,0.9465021,0.77884614,0.8156863,0.16535948,1.0,1.0,
                        0.8518518,0.82894737,0.29803923,0.67085075,0.9484127,0.9882353,0.07101449,0.6497175,0.69411767,0.16499163,0.8504273,0.91764706,
                        0.26900586,0.32386363,0.6901961,0.71868974,0.8917526,0.7607843,0.18181817,0.969163,0.8901961,0.0,0.7092511,0.8901961,
                        0.7554517,0.5879121,0.7137255,0.6075757,0.4888889,0.88235295,0.85271317,0.86,0.39215687,0.1884058,0.5822785,0.92941177,
                        0.0,0.084745765,0.9254902,0.66825396,0.495283,0.83137256,0.34375,0.3137255,0.2,0.0,0.98406374,0.9843137,
                        0.5160744,0.78486055,0.9843137,0.1789366,0.7212389,0.8862745,0.52849007,0.9212598,0.99607843,0.0,0.98406374,0.9843137,
                        0.122719735,0.8445378,0.93333334,0.069010414,0.84210527,0.59607846,0.9558824,0.19767442,0.6745098,0.0,0.0,1.0,
                        0.6927083,0.97959185,0.38431373,0.375,0.90909094,0.5176471,0.39340103,0.9380952,0.8235294,0.0,0.0,1.0,
                        0.14957266,0.4814815,0.63529414,0.94973546,0.75,0.9882353,0.9147287,0.6771653,0.49803922,0.0,0.0,1.0,
                        0.2715356,0.9368421,0.37254903,0.056962024,0.3172691,0.9764706,0.3826165,0.7322835,0.99607843,0.26453486,1.0,0.6745098,
                        0.38095236,0.15107913,0.54509807,0.5763052,0.80582523,0.80784315,0.29296064,0.6851064,0.92156863,0.0,0.0,1.0,
                        0.3977591,0.6296296,0.7411765,0.6491228,0.3153527,0.94509804,0.8989899,0.36263737,0.7137255,0.0,0.0,1.0,
                        0.125,0.549763,0.827451,0.15860215,0.37349397,0.6509804,0.76262623,0.3316583,0.78039217,0.0,0.0,0.0,
                        0.99065423,0.80451125,0.52156866,0.8264957,0.88235295,0.8666667,0.6578948,0.97938144,0.7607843,0.0,0.0,1.0,
                        0.57007575,0.94623655,0.3647059,0.9395833,0.3305785,0.9490196,0.13988096,0.96,0.6862745,0.0,0.0,1.0,
                        0.80229884,0.7512953,0.75686276,0.013468017,0.70714283,0.54901963,0.63715273,0.82758623,0.9098039,0.0,0.0,1.0,
                        0.28467909,0.63385826,0.99607843,0.40229884,0.80930233,0.84313726,0.8687392,0.8733032,0.8666667,0.0,0.0,0.0,
                        0.21910112,0.67424244,0.5176471,0.6394558,0.33333334,0.5764706,0.9114219,0.65,0.8627451,0.0,0.0,1.0,
                        0.4325397,0.7590361,0.6509804,0.3026316,0.20652173,0.72156864,0.8947368,0.60181,0.8666667,0.15686275,1.0,1.0,
                        0.95156693,0.5879397,0.78039217,0.55662394,0.7536232,0.8117647,0.36809817,0.85340315,0.7490196,0.15686275,1.0,1.0,
                        0.8842593,0.96,0.5882353,0.12704918,0.64893615,0.7372549,0.64311594,0.8214286,0.4392157,0.15686275,1.0,1.0,
                        0.96875,0.25668448,0.73333335,0.23106058,0.556962,0.61960787,0.9270833,0.6473988,0.6784314,0.15686275,1.0,1.0
    ];
        
        var layer_defs = [];
        layer_defs.push({type:'input', out_sx:1, out_sy:1, out_depth:9});
        layer_defs.push({type:'fc', num_neurons:100, activation:'sigmoid'});
        layer_defs.push({type:'regression', num_neurons:3});

        var net = new convnetjs.Net();
        net.makeLayers(layer_defs);

        // Create trainer and train on given dataset.
        var trainer = new convnetjs.Trainer(net,
                                            {method: 'adadelta', l2_decay: 0.001, batch_size: 1});

        var steps = 3000;
        while (steps >= 0) {
            steps --;
            avgloss = 0.0;

            for (var i = 0; i < pre_trained_data.length; i += 12) {
                var vol3d = new convnetjs.Vol(1, 1, 9);
            
                vol3d.set(0, 0, 0, 360 * pre_trained_data[i + 0]);
                vol3d.set(0, 0, 1, 100 * pre_trained_data[i + 1]);
                vol3d.set(0, 0, 2, 100 * pre_trained_data[i + 2]);
                vol3d.set(0, 0, 3, 360 * pre_trained_data[i + 3]);
                vol3d.set(0, 0, 4, 100 * pre_trained_data[i + 4]);
                vol3d.set(0, 0, 5, 100 * pre_trained_data[i + 5]);
                vol3d.set(0, 0, 6, 360 * pre_trained_data[i + 6]);
                vol3d.set(0, 0, 7, 100 * pre_trained_data[i + 7]);
                vol3d.set(0, 0, 8, 100 * pre_trained_data[i + 8]);
            
                result = [];
                result[0] = 360 * pre_trained_data[i + 9];
                result[1] = 100 * pre_trained_data[i + 10];
                result[2] = 100 * pre_trained_data[i + 11];
            
                trainer.train(vol3d, result);
            
                avgloss += (trainer.train(vol3d, result)).loss;
            }
        
            console.log("[" + steps + "] Loss: " + (avgloss / (pre_trained_data.length/12)));
        }


        // Test. Predict on given datapoints.
        for (var i = 0; i < pre_trained_data.length; i += 12) {
            var vol3d = new convnetjs.Vol(1, 1, 9);
        
            vol3d.set(0, 0, 0, 360 * pre_trained_data[i + 0]);
            vol3d.set(0, 0, 1, 100 * pre_trained_data[i + 1]);
            vol3d.set(0, 0, 2, 100 * pre_trained_data[i + 2]);
            vol3d.set(0, 0, 3, 360 * pre_trained_data[i + 3]);
            vol3d.set(0, 0, 4, 100 * pre_trained_data[i + 4]);
            vol3d.set(0, 0, 5, 100 * pre_trained_data[i + 5]);
            vol3d.set(0, 0, 6, 360 * pre_trained_data[i + 6]);
            vol3d.set(0, 0, 7, 100 * pre_trained_data[i + 7]);
            vol3d.set(0, 0, 8, 100 * pre_trained_data[i + 8]);
        
            var predicted_values = net.forward(vol3d);
        
            console.log("predicted values: %o", predicted_values);
        }

        // Test. Other predictions.
        var my_vol3d = new convnetjs.Vol(1, 1, 9);
        
        my_vol3d.set(0, 0, 0, 169);
        my_vol3d.set(0, 0, 1, 13);
        my_vol3d.set(0, 0, 2, 85);
        my_vol3d.set(0, 0, 3, 151);
        my_vol3d.set(0, 0, 4, 22);
        my_vol3d.set(0, 0, 5, 56);
        my_vol3d.set(0, 0, 6, 142);
        my_vol3d.set(0, 0, 7, 26);
        my_vol3d.set(0, 0, 8, 24);
        
        var my_predicted_value = net.forward(my_vol3d);
        
        console.log("my predicted values: %o", my_predicted_value);
        
</script>

</body>
<html>